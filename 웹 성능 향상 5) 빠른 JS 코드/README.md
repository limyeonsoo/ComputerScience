# Web 성능 향상 방법론 5. 빠른 JS 코드 작성하기.

## 1. 코드 최소화 하기.

## 2. 필요할 때만 script 사용 (flag 사용)

예를들어 어떤게 있을까?

- React에 보면 동적으로 <script> 를 넣을 수 있는 Helmet이라는 라이브러리가 있음.
- 종종 appendChild(script) 를 해주고 unmount 될 때 removeChild를 해주는 것도 이 경우인 것 같음.

## 3. DOM에 대한 접근 최소화.

기본적으로 DOM 요소에 대한 manipulate 는 매우 느리다. 

→ React는 가상 DOM을 사용하므로 속도를 개선 하였다.  [//](//f) 렌더링 측면.

### 4. 다수의 element를 찾을 때는 selector API 사용.

??? 왜그럴까

일단  getElementById  vs  querySeletor 에서는

![Web%20%E1%84%89%E1%85%A5%E1%86%BC%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%92%E1%85%A3%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%86%AB%205%20%E1%84%88%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20JS%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%208acea798cfbd4eda990b64cdd872e941/Untitled.png](Web%20%E1%84%89%E1%85%A5%E1%86%BC%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%92%E1%85%A3%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%86%AB%205%20%E1%84%88%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20JS%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%208acea798cfbd4eda990b64cdd872e941/Untitled.png)

getElementById가 1.2배 빠르다고 한다.

하지만, 여러 element 라는 가정이 있으니 여러번 DOM 에 접근하는 것 보다야 querySelectorAll 이 낫지 않을까.

### 5. 마크업 변경은 한 번에 할 것.

이것 또한 innerHTML 등 DOM 요소에 잦은 접근을 피하라는 뜻.

### 6. DOM의 크기를 작게 유지.

![Web%20%E1%84%89%E1%85%A5%E1%86%BC%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%92%E1%85%A3%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%86%AB%205%20%E1%84%88%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20JS%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%208acea798cfbd4eda990b64cdd872e941/Untitled.png](Web%20%E1%84%89%E1%85%A5%E1%86%BC%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%92%E1%85%A3%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%86%AB%205%20%E1%84%88%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20JS%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%208acea798cfbd4eda990b64cdd872e941/Untitled.png)

getElementById가 1.2배 빠르다고 한다.

하지만, 여러 element 라는 가정이 있으니 여러번 DOM 에 접근하는 것 보다야 querySelectorAll 이 낫지 않을까.

## 7. 내장 JSON 메소드 사용.

`JSON.parse`

`JSON.stringify`

- key : value 를 표현하는 방법.
1. 객체 리터럴 방식

    ```html
    const data = {
    	foo : 'foo',
      bar : 'bar',
    	...
    };
    ```

2. JSON 메소드 방식.

    ```html
    const data = JSON.parse('{"foo":"foo", "bar":"bar", ...}');
    ```

< SSR (서버 사이드 렌더링)을 하는 이유 > 

대부분 JavaScript 프로젝트, React 프로젝트 등은 객체로 이루어져있는데, 이 객체를 제공할 때 아주 많은 크기의 데이터, 속도가 소비된다.

서버 사이드 렌더링을 하면 로드 될 때 위의 객체들이 이미 처리가 끝난 상태. ⇒ 성능 향상

JS 리터럴 보다 JSON 이 빠를 수 있는 이유.

1. 읽고 분석 하기가 쉽다 (파싱이 쉽다)

    JSON 은 단지 토큰의 결합,
    객체는 숫자, 문자열, 불린, 배열, 객체 등...

2. 경우의 수가 적다 ( 파싱이 쉽다)

    JSON parse 시에 중괄호{  를 만났을 때. 
    1. 객체의 시작. 
    2. 잘못된 JSON
    둘 중 하나.

    But, 객체리터럴 에서는
    그냥 객체,
    객체 비구조화,
    화살표 함수,
    등 등 너무 많은 요소가 있을 수 있음.

    이 또한 1번과 같은 장점.

![Web%20%E1%84%89%E1%85%A5%E1%86%BC%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%92%E1%85%A3%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%86%AB%205%20%E1%84%88%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20JS%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%208acea798cfbd4eda990b64cdd872e941/Untitled%201.png](Web%20%E1%84%89%E1%85%A5%E1%86%BC%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%92%E1%85%A3%E1%86%BC%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%E1%84%85%E1%85%A9%E1%86%AB%205%20%E1%84%88%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20JS%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%208acea798cfbd4eda990b64cdd872e941/Untitled%201.png)